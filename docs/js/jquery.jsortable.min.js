/*
 * https://github.com/rohanrhu/jsortable
 * Copyright (C) 2015, Oğuzhan Eroğlu <rohanrhu2@gmail.com>
 * Licensed under MIT
 */

!function(e){var t={init:function(t){var a=this,r=e(this);"undefined"==typeof t&&(t={}),a.parameters=t,a.parameters.show_source_placeholder="undefined"!=typeof a.parameters.show_source_placeholder?a.parameters.show_source_placeholder:!0,a.parameters.show_target_placeholder="undefined"!=typeof a.parameters.show_target_placeholder?a.parameters.show_target_placeholder:!0,r.each(function(){var t=e(this),r={};t.data("jsortable",r),r.$jsortable_sortable_s=t.find(a.parameters.sortable),r.$jsortable_sortable_s__order=t.find(a.parameters.sortable);var o=e("body");t.on("jsortable_initialize.jsortable",function(){r.initialize()}),r.initialize=function(){},t.addClass("jsortable");var s=e("<div></div>");s.addClass("__proto"),s.addClass("jsortable_placeholder"),s.css({background:"#f1f1f1",position:"relative"});var i=e("<div></div>");i.addClass("__proto"),i.addClass("sortablePlaceholder_layer1"),i.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",border:"1px dashed rgba(0,0,0,0.2)"}),r.$jsortable_sortable_s.each(function(){var t=e(this),a={};t.data("jsortable",a)}),r.updateIndexes=function(){r.$jsortable_sortable_s__order=t.find(a.parameters.sortable);var o=0;r.$jsortable_sortable_s__order.each(function(){var t=e(this),a=t.data("jsortable");a.index=o++})},r.updateIndexes(),r.$jsortable_sortable_s.each(function(){var t=e(this),l=t.data("jsortable"),n=s.clone(!0),d=s.clone(!0),p=i.clone(!0);p.removeClass("__proto"),p.css({"border-radius":t.css("border-radius")}),n.removeClass("__proto"),n.width(t.outerWidth()),n.height(t.outerHeight()),n.css({"float":t.css("float"),display:t.css("display")}),a.parameters.show_source_placeholder?(n.css({"margin-left":t.css("margin-left"),"margin-right":t.css("margin-right"),"margin-top":t.css("margin-top"),"margin-bottom":t.css("margin-bottom")}),p.clone(!0).appendTo(n)):n.css({overflow:"hidden"}).width(0).height(0),d.removeClass("__proto"),d.width(t.outerWidth()),d.height(t.outerHeight()),d.css({"float":t.css("float"),display:t.css("display")}),a.parameters.show_target_placeholder?(d.css({"margin-left":t.css("margin-left"),"margin-right":t.css("margin-right"),"margin-top":t.css("margin-top"),"margin-bottom":t.css("margin-bottom")}),p.clone(!0).appendTo(d)):d.css({overflow:"hidden"}).width(0).height(0),r.sortable_state={},r.sortable_state.need_drop=!1,r.sortable_state.drop_to=null,t.on("draginit.jsortable",function(){r.updateIndexes(),r.sortable_state.need_drop=!1}),t.on("dragstart.jsortable",function(e){n.insertAfter(t),t.css({position:"absolute",left:e.pageX,top:e.pageY}),t.appendTo(o)}),t.on("drag.jsortable",function(a){var o=a.pageX-t.outerWidth()/2,s=a.pageY-t.outerHeight()/2;t.css({left:o,top:s});var i=0;r.$jsortable_sortable_s__order.not(t).each(function(){var t,o,s,n,p=e(this),_=(p.data("jsortable"),p.offset().left),c=_+p.outerWidth(),b=p.offset().top,g=b+p.outerHeight(),h=function(){t=d.offset().left,o=t+d.outerWidth(),s=d.offset().top,n=s+d.outerHeight()};return h(),l.index!=i&&0!=i&&a.pageX>_&&a.pageX<c&&a.pageY>b&&a.pageY<g?(d.insertBefore(p),r.sortable_state.need_drop=!0,r.sortable_state.drop_to=d,!1):l.index!=r.$jsortable_sortable_s__order.length-1&&i==r.$jsortable_sortable_s__order.length-2&&(a.pageX>c&&a.pageY>b&&a.pageY<g||a.pageY>g&&a.pageX>_&&a.pageX<c)?(d.insertAfter(p),r.sortable_state.need_drop=!0,r.sortable_state.drop_to=d,!1):0!=l.index&&0==i&&a.pageX>_&&a.pageX<c&&a.pageY>b&&a.pageY<g?(d.insertBefore(p),r.sortable_state.need_drop=!0,r.sortable_state.drop_to=d,!1):(a.pageX>t&&a.pageX<o&&a.pageY>s&&a.pageY<n||(r.sortable_state.need_drop=!1,r.sortable_state.drop_to=null,d.remove()),void i++)})}),t.on("dragend.jsortable",function(){t.insertAfter(r.sortable_state.need_drop?d:n),t.css({position:"static",top:"auto",left:"auto"}),n.remove(),d.remove(),r.updateIndexes(),r.sortable_state.need_drop&&(t.trigger("jsortable_updated"),r.sortable_state.need_drop=!1)})}),r.initialize()})},getElements:function(){var t=e(this),a=t.data("jsortable");return a.$jsortable_sortable_s__order}};e.fn.jsortable=function(a){return t[a]?t[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void e.error("Method "+a+" does not exist on jQuery.jsortable"):t.init.apply(this,arguments)}}(jQuery);